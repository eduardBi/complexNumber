<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        body{
            font-size: 20px;
        }
        .minimized{
            font-size: 15px;
        }

        
    </style>
</head>
<body>


















<script>


let tokStank={
    firstPower:{
          powerNumber:12,
          numberOfrecivers:15,
          usageMultiplier:0.2,
          cosinous:0.65,
          powerOfWork:1,
          tangX:1.17
        },second:{
          powerNumber:5,
          numberOfrecivers:4,
          usageMultiplier:0.2,
          cosinous:0.65,
          powerOfWork:1,
          tangX:1.17
        },thirdONe:{
          powerNumber:5,
          numberOfrecivers:2,
          usageMultiplier:0.2,
          cosinous:0.65,
          powerOfWork:1,
          tangX:1.17
        },fourth:{
          powerNumber:9,
          numberOfrecivers:2,
          usageMultiplier:0.2,
          cosinous:0.65,
          powerOfWork:1,
          tangX:1.17
        },
        fith:{
          powerNumber:5.4,
          numberOfrecivers:8,
          usageMultiplier:0.2,
          cosinous:0.65,
          powerOfWork:1,
          tangX:1.17
        },
        sixth:{
          powerNumber:1,
          numberOfrecivers:14,
          usageMultiplier:0.2,
          cosinous:0.7,
          powerOfWork:1,
          tangX:1.17
        },
        seventh:{
          powerNumber:5,
          numberOfrecivers:8,
          usageMultiplier:0.2,
          cosinous:0.7,
          powerOfWork:1,
          tangX:1.17
        },
        eightth:{
          powerNumber:10,
          numberOfrecivers:3,
          usageMultiplier:0.2,
          cosinous:0.7,
          powerOfWork:1,
          tangX:1.17
        },nineth:{
          powerNumber:30,
          numberOfrecivers:6,
          usageMultiplier:0.2,
          cosinous:0.7,
          powerOfWork:1,
          tangX:1.17
        },tenth:{
          powerNumber:3,
          numberOfrecivers:4,
          usageMultiplier:0.2,
          cosinous:0.7,
          powerOfWork:1,
          tangX:1.17
        },
        eleventh:{
          powerNumber:5,
          numberOfrecivers:11,
          usageMultiplier:0.2,
          cosinous:0.7,
          powerOfWork:1,
          tangX:1.17
        },
        twelth:{
          powerNumber:15,
          numberOfrecivers:5,
          usageMultiplier:0.2,
          cosinous:0.7,
          powerOfWork:1,
          tangX:1.17
        },
        thirteenth:{
          powerNumber:31,
          numberOfrecivers:2,
          usageMultiplier:0.2,
          cosinous:0.7,
          powerOfWork:1,
          tangX:1.17
        },fourtenth:{
          powerNumber:7,
          numberOfrecivers:4,
          usageMultiplier:0.7,
          cosinous:0.7,
          powerOfWork:1,
          tangX:0.75
        },
        fithteenth:{
          powerNumber:10,
          numberOfrecivers:3,
          usageMultiplier:0.1,
          cosinous:0.7,
          powerOfWork:0.4,
          tangX:1.73
        },
        
        
        
}

function findAlike(tokStanki){
    let keys = Object.keys(tokStanki);
    let sameGroup=[];
    let newObject=0;
    
    for(let i=0;i<keys.length;i++){
        console.log(newObject);
        let object=tokStanki[keys[i]];
        if(sameGroup.length==0){
            // starts if there is no info 
            sameGroup.push([tokStanki[keys[i]]]);
            
            console.log('filled')    
            
        }else if(sameGroup.length!=0 && sameGroup[newObject][0].tangX==tokStanki[keys[i]].tangX &&sameGroup[newObject][0].usageMultiplier==tokStanki[keys[i]].usageMultiplier ){
    
            sameGroup[newObject][sameGroup[newObject].length]=tokStanki[keys[i]];
            
            
            
        }else {
            console.log('never');
            sameGroup.push([
            tokStanki[keys[i]]
            ]);
            newObject++;
         }
        
    }
    return sameGroup;
}

let classified = findAlike(tokStank); 

function activePower(classified){
    let powerOfGroup=[];
    for(let i=0 ; i<classified.length;i++){
        let currentNumber=0;
        for(let j=0 ; j<classified[i].length;j++){
            currentNumber+=classified[i][j].powerNumber*classified[i][j].numberOfrecivers*classified[i][j].usageMultiplier*Math.sqrt(classified[i][j].powerOfWork);
            console.log(classified[i][j].powerNumber*classified[i][j].numberOfrecivers*classified[i][j].usageMultiplier*Math.sqrt(classified[i][j].powerOfWork))
    }   
    
    powerOfGroup.push({power:currentNumber,tangX:classified[i][0].tangX}) 
    }
    console.log(powerOfGroup)
    return powerOfGroup
}


let fullPowerOfGroup=activePower(classified);
console.log(fullPowerOfGroup)


function getEffectiveNumber(classified){
    let powerOfGroup=[];
    let arrayOfefectiveNumbers=[];
    
    for(let i=0 ; i<classified.length;i++){

    // прохожу по отсортированному массиву 
        let maxNumber=0;
        let minNumber=0;
        let sumOfPower=0;
    for(let j=0 ; j<classified[i].length;j++)
        {
            // прохожу по каждому элементу в сгруппированном объeктe   
            if(classified[i][j].powerNumber>maxNumber)
            {
                maxNumber=classified[i][j].powerNumber
                
            }
            sumOfPower+=classified[i][j].powerNumber*classified[i][j].numberOfrecivers;            
        }
        
        powerOfGroup[i]=sumOfPower
    

        let effectiveNumberOfRecivers=((2*powerOfGroup[i]))/maxNumber
        
        arrayOfefectiveNumbers.push(effectiveNumberOfRecivers)
        //можно заменить powerOfGroup[i] на макс намбер 
        
    }
    console.log(arrayOfefectiveNumbers)
    return   arrayOfefectiveNumbers;

}

let arrayOfefectiveNumbers= getEffectiveNumber(classified)


function reactivePOwer(array, arrayOfefectiveNumbers){
    let fullPower=[];
    for (let i = 0; i < array.length; i++) {
        console.log(array)
        const element = array[i];
        if(arrayOfefectiveNumbers[i]>10){
            let reactivePower=1*array[i].tangX*array[i].power
            fullPower.push(reactivePower)
        }else{
            let reactivePower=1.1*array[i].tangX*array[i].power
            fullPower.push(reactivePower)
        }    
    }
    console.log(fullPower)
    return fullPower;
}

let reacivePowers=reactivePOwer(fullPowerOfGroup,arrayOfefectiveNumbers);


function fullPowerOfFacility(array1 , array2){
    let fullPowersArray=[];
    let summedPower=0
    for (let i = 0; i < array1.length; i++) {
        
         let element = Math.sqrt(array1[i]*array1[i]+array2[i].power*array2[i].power);
         fullPowersArray.push(element)
         summedPower+=element
        
    }
    
    console.log(fullPowersArray)

    return fullPowersArray

}
fullPowerOfFacility(reacivePowers,fullPowerOfGroup);


</script></body>
</html>